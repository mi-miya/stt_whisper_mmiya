# ローカル Whisper 音声入力システム (Windows用)

パソコンの中で動く「音声入力ツール」です。
ネットに繋がなくても、ショートカットキーやボタンひとつで声を文字にして、クリップボードにコピーしてくれます。

## ✨ 特徴
- **どこでも入力**: メモ帳、ブラウザ、Word、どこでも使えます。
- **高速・高精度**: OpenAI Whisper を使ってローカル（自分のPC内）で変換します。
- **安心プライバシー**: 音声データはネットに送信されません。
- **かんたん操作**: マイクボタンをクリック、またはキーを押すだけ。
- **効果音付き**: 画面を見なくても「ピッ」「ピピッ」と音でわかります。

## 📦 準備するもの

1. **Python (パイソン) のインストール**
   - まだ入っていない場合は [公式サイト](https://www.python.org/downloads/) からインストールしてください。
   - インストール時、**"Add Python to PATH"** にチェックを入れるのを忘れずに！

2. **Whisper 本体（エンジン）**
   - [whisper.cpp のリリースページ](https://github.com/ggml-org/whisper.cpp/releases) を開きます。
   - `whisper-bin-x64.zip` (GPUを使うなら `whisper-bin-x64-cu12.zip` など) をダウンロードします。
   - 解凍して、中に入っている `whisper-cli.exe` と `*.dll` 系のファイルをすべて **`bin`** フォルダに入れます。

3. **AIモデル (辞書)**
   - [Hugging Face](https://huggingface.co/ggerganov/whisper.cpp/tree/main) から `ggml-small.bin` (または `ggml-base.bin`) をダウンロードします。
   - これを **`models`** フォルダに入れます。

## 🚀 インストール

1. このフォルダにある **`install.bat`** をダブルクリックします。
2. 黒い画面が出て、必要なプログラムが自動で入ります。「Installation complete!」と出たら閉じてOKです。

## 🎤 使い方

1. **起動する**
   - **`launch.vbs`** をダブルクリックします。
   - 何も画面は出ませんが、左上に「緑のマイクアイコン」が出れば起動成功です。

2. **文字入力する**
   - **マイクアイコンをクリック** するか、
   - キーボードの **`Ctrl` + `Alt` + `Shift` + `J`** を押します（初期設定）。
   - 「ピッ」と鳴ってアイコンが赤くなったら喋ります。
   - もう一度クリック（またはキー）を押すと「ピピッ」と鳴り、文字がクリップボードに入ります（設定によっては自動貼り付けされます）。

3. **終了する**
   - マイクアイコンを右クリック → **Exit** を選んでください。

## ⚙️ 設定 (もっと便利に)

`config.json` というファイルをメモ帳で開くと設定を変えられます。

- `"sound_enabled"`: `true` で音あり、`false` で音なし。
- `"n_gpu_layers"`: NVIDIAのグラボを使う場合は `0` から `99` に変えると爆速になります（別途GPU版のファイルが必要）。
- `"hotkey"`: キー割り当てを変えられます（例: `<ctrl>+<space>` など）。

## ❓ 困ったときは

- **文字起こしされない**: `bin` フォルダに `whisper-cli.exe` はありますか？ `models` フォルダにモデルはありますか？
- **起動しない**: `debug.bat` をダブルクリックしてみてください。エラーメッセージが表示されるので、それを教えてください。
